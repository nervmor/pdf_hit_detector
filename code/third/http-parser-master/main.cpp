#include "http_parser.h"

char peer1_0[] = {
	0x48, 0x54, 0x54, 0x50, 0x2f, 0x31, 0x2e, 0x31, 
	0x20, 0x32, 0x30, 0x30, 0x20, 0x4f, 0x4b, 0x0d, 
	0x0a, 0x44, 0x61, 0x74, 0x65, 0x3a, 0x20, 0x4d, 
	0x6f, 0x6e, 0x2c, 0x20, 0x32, 0x30, 0x20, 0x41, 
	0x70, 0x72, 0x20, 0x32, 0x30, 0x31, 0x35, 0x20, 
	0x31, 0x30, 0x3a, 0x35, 0x39, 0x3a, 0x31, 0x38, 
	0x20, 0x47, 0x4d, 0x54, 0x0d, 0x0a, 0x53, 0x65, 
	0x72, 0x76, 0x65, 0x72, 0x3a, 0x20, 0x41, 0x70, 
	0x61, 0x63, 0x68, 0x65, 0x2f, 0x32, 0x2e, 0x34, 
	0x2e, 0x31, 0x32, 0x20, 0x28, 0x57, 0x69, 0x6e, 
	0x36, 0x34, 0x29, 0x20, 0x4f, 0x70, 0x65, 0x6e, 
	0x53, 0x53, 0x4c, 0x2f, 0x31, 0x2e, 0x30, 0x2e, 
	0x31, 0x6d, 0x0d, 0x0a, 0x58, 0x2d, 0x44, 0x69, 
	0x73, 0x74, 0x72, 0x69, 0x62, 0x75, 0x74, 0x6f, 
	0x72, 0x3a, 0x20, 0x41, 0x48, 0x43, 0x0d, 0x0a, 
	0x4c, 0x61, 0x73, 0x74, 0x2d, 0x4d, 0x6f, 0x64, 
	0x69, 0x66, 0x69, 0x65, 0x64, 0x3a, 0x20, 0x53, 
	0x61, 0x74, 0x2c, 0x20, 0x31, 0x38, 0x20, 0x41, 
	0x70, 0x72, 0x20, 0x32, 0x30, 0x31, 0x35, 0x20, 
	0x30, 0x32, 0x3a, 0x30, 0x30, 0x3a, 0x32, 0x35, 
	0x20, 0x47, 0x4d, 0x54, 0x0d, 0x0a, 0x45, 0x54, 
	0x61, 0x67, 0x3a, 0x20, 0x22, 0x34, 0x2d, 0x35, 
	0x31, 0x33, 0x66, 0x36, 0x30, 0x66, 0x37, 0x32, 
	0x34, 0x37, 0x63, 0x62, 0x22, 0x0d, 0x0a, 0x41, 
	0x63, 0x63, 0x65, 0x70, 0x74, 0x2d, 0x52, 0x61, 
	0x6e, 0x67, 0x65, 0x73, 0x3a, 0x20, 0x62, 0x79, 
	0x74, 0x65, 0x73, 0x0d, 0x0a, 0x43, 0x6f, 0x6e, 
	0x74, 0x65, 0x6e, 0x74, 0x2d, 0x4c, 0x65, 0x6e, 
	0x67, 0x74, 0x68, 0x3a, 0x20, 0x34, 0x0d, 0x0a, 
	0x4b, 0x65, 0x65, 0x70, 0x2d, 0x41, 0x6c, 0x69, 
	0x76, 0x65, 0x3a, 0x20, 0x74, 0x69, 0x6d, 0x65, 
	0x6f, 0x75, 0x74, 0x3d, 0x35, 0x2c, 0x20, 0x6d, 
	0x61, 0x78, 0x3d, 0x31, 0x30, 0x30, 0x0d, 0x0a, 
	0x43, 0x6f, 0x6e, 0x6e, 0x65, 0x63, 0x74, 0x69, 
	0x6f, 0x6e, 0x3a, 0x20, 0x4b, 0x65, 0x65, 0x70, 
	0x2d, 0x41, 0x6c, 0x69, 0x76, 0x65, 0x0d, 0x0a, 
	0x43, 0x6f, 0x6e, 0x74, 0x65, 0x6e, 0x74, 0x2d, 
	0x54, 0x79, 0x70, 0x65, 0x3a, 0x20, 0x74, 0x65, 
	0x78, 0x74, 0x2f, 0x68, 0x74, 0x6d, 0x6c, 0x0d, 
	0x0a, 0x0d, 0x0a, 0x66, 0x75, 0x63, 0x6b };



int http_data_cb_on_body(http_parser*, const char *at, size_t length)
{
	return 0;
}
int http_data_cb_on_header_field(http_parser*, const char *at, size_t length)
{
	return 0;
}
int http_data_cb_on_header_value(http_parser*, const char *at, size_t length)
{
	return 0;
}
int http_data_cb_on_headers_complete(http_parser*)
{
	return 0;
}
int http_data_cb_on_message_begin(http_parser*)
{
	return 0;
}
int http_data_cb_on_message_complete(http_parser*)
{
	return 0;
}
int http_data_cb_on_status(http_parser*, const char *at, size_t length)
{
	return 0;
}
int http_data_cb_on_url(http_parser*, const char *at, size_t length)
{
	return 0;
}
void main()
{
	http_parser_settings setting;
	setting.on_body = http_data_cb_on_body;
	setting.on_header_field = http_data_cb_on_header_field;
	setting.on_header_value = http_data_cb_on_header_value;
	setting.on_headers_complete = http_data_cb_on_headers_complete;
	setting.on_message_begin = http_data_cb_on_message_begin;
	setting.on_message_complete = http_data_cb_on_message_complete;
	setting.on_status = http_data_cb_on_status;
	setting.on_url = http_data_cb_on_url;
	
	http_parser* p_parser = new http_parser;

	http_parser_init(p_parser, HTTP_RESPONSE);

	size_t data_size = sizeof(peer1_0);

	char* p_data = peer1_0;
	for (int i = 0; i != sizeof(peer1_0); i+=100)
	{
		size_t size = http_parser_execute(p_parser, &setting, &p_data[i], 100);
		if (size == 1)
		{
			int a = 3;
		}
	}
	//size_t size = http_parser_execute(p_parser, &setting, peer1_0, sizeof(peer1_0));

	int a  = 3;
}